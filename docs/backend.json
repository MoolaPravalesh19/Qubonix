{
  "entities": {
    "InternApplication": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "InternApplication",
      "type": "object",
      "description": "Represents an application submitted by a prospective intern.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the intern application."
        },
        "fullName": {
          "type": "string",
          "description": "The full name of the applicant."
        },
        "email": {
          "type": "string",
          "description": "The email address of the applicant.",
          "format": "email"
        },
        "phone": {
          "type": "string",
          "description": "The phone number of the applicant."
        },
        "collegeName": {
          "type": "string",
          "description": "The name of the college the applicant attends."
        },
        "courseBranch": {
          "type": "string",
          "description": "The course or branch of study for the applicant."
        },
        "currentYearSem": {
          "type": "string",
          "description": "The current year or semester of the applicant's studies."
        },
        "skills": {
          "type": "string",
          "description": "A list of the applicant's skills."
        },
        "preferredDomain": {
          "type": "string",
          "description": "The applicant's preferred domain for the internship (Web, App, UI/UX, Backend)."
        },
        "duration": {
          "type": "string",
          "description": "The desired duration of the internship in months (1, 2, or 3)."
        },
        "resumeUrl": {
          "type": "string",
          "description": "URL of the resume uploaded by the applicant."
        },
        "whySelect": {
          "type": "string",
          "description": "The applicant's statement on why they should be selected."
        },
        "status": {
          "type": "string",
          "description": "The status of the intern application (e.g., pending, approved, rejected)."
        }
      },
      "required": [
        "id",
        "fullName",
        "email",
        "phone",
        "collegeName",
        "courseBranch",
        "currentYearSem",
        "skills",
        "preferredDomain",
        "duration",
        "resumeUrl",
        "whySelect",
        "status"
      ]
    },
    "Intern": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Intern",
      "type": "object",
      "description": "Represents an intern user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the intern user."
        },
        "email": {
          "type": "string",
          "description": "The email address of the intern.",
          "format": "email"
        },
        "applicationId": {
          "type": "string",
          "description": "Reference to InternApplication. (Relationship: Intern 1:1 InternApplication)"
        }
      },
      "required": [
        "id",
        "email",
        "applicationId"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task assigned to an intern.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the task."
        },
        "internId": {
          "type": "string",
          "description": "Reference to Intern. (Relationship: Intern 1:N Task)"
        },
        "title": {
          "type": "string",
          "description": "The title of the task."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the task."
        },
        "deadline": {
          "type": "string",
          "description": "The deadline for the task.",
          "format": "date-time"
        },
        "submittedWorkUrl": {
          "type": "string",
          "description": "URL of the submitted work file."
        },
        "submissionMessage": {
          "type": "string",
          "description": "A message or notes accompanying the submitted work."
        }
      },
      "required": [
        "id",
        "internId",
        "title",
        "description",
        "deadline"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/intern_applications/{internApplicationId}",
        "definition": {
          "entityName": "InternApplication",
          "schema": {
            "$ref": "#/backend/entities/InternApplication"
          },
          "description": "Stores intern application data. Accessible to admins for review and management.",
          "params": [
            {
              "name": "internApplicationId",
              "description": "The unique ID of the intern application."
            }
          ]
        }
      },
      {
        "path": "/interns/{internId}",
        "definition": {
          "entityName": "Intern",
          "schema": {
            "$ref": "#/backend/entities/Intern"
          },
          "description": "Stores intern account data. The 'applicationId' field references the corresponding InternApplication document.",
          "params": [
            {
              "name": "internId",
              "description": "The unique ID of the intern."
            }
          ]
        }
      },
      {
        "path": "/interns/{internId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks assigned to a specific intern. Path-based ownership ensures interns can only access their own tasks.",
          "params": [
            {
              "name": "internId",
              "description": "The unique ID of the intern."
            },
            {
              "name": "taskId",
              "description": "The unique ID of the task."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "adminRole",
          "schema": {
            "$ref": "#/backend/entities/Intern"
          },
          "description": "Collection to store UIDs of admin users. Existence of a document grants admin privileges.",
          "params": [
            {
              "name": "userId",
              "description": "The unique ID of the admin user."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to manage intern applications, intern accounts, and associated tasks for Qubnix Technologies. It emphasizes authorization independence and clear access control. The structure incorporates the following key features:\n\n1.  **Intern Applications:**  Applications are stored in the `intern_applications` collection.  This collection is accessible to administrators for review and management.\n2.  **Intern Accounts:** Once an application is approved, an intern account is created in the `interns` collection. The `interns` collection links back to the `intern_applications` document via the `applicationId` field, ensuring a clear relationship between the application and the intern account.\n3.  **Tasks:** Each intern has a subcollection `tasks` to store their assigned tasks. The tasks documents includes a reference to the intern through the `internId` field.\n4. **Admin Roles**: Admins are managed through the presence of a document with their UID in the `/roles_admin` collection. This existence-based check ensures easy and secure role management.\n\n**Authorization Independence & Security Rules:**\n\n*   **Admin Access:** The security rules will check for the existence of a document in the `roles_admin` collection to grant admin privileges. This avoids complex queries and ensures efficient security rule evaluation.\n*   **Intern Access:** Interns can only access their own task data via path-based rules `/users/{userId}/tasks/{taskId}`. These rules will ensure the request.auth.uid matches the internId on the task.\n\n**QAPs (Rules are not Filters):**\n\n*   The structure enables secure `list` operations by leveraging structural segregation. Only admins can `list` applications. Interns can only access their own tasks, preventing unauthorized data access.\n\n**Denormalization:**\n\nWhile not explicitly denormalizing membership maps, this design achieves Authorization Independence by leveraging path-based ownership for interns and existence checks for admin roles.  This eliminates the need for `get()` calls in security rules, promoting atomicity and simplifying debugging."
  }
}